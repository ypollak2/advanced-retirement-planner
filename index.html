<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced Retirement Planner - Professional Pension Planning Tool</title>
    <meta name="description" content="Advanced retirement planning tool with comprehensive investment tracking, FIRE calculator, partner planning, and stress testing">
    <meta name="keywords" content="retirement, pension planning, retirement calculator, pension savings, training fund, investment planning, partner planning, family financial planning">
    
    <!-- Tailwind CSS via CDN (optimized for production) -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    
    <!-- React & ReactDOM from CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        /* Modern Financial Planning UI - Inspired by Personal Capital, Wealthfront, Mint */
        
        :root {
            /* Modern Financial Palette - Enhanced */
            --primary-blue: #1e40af; /* Professional trustworthy blue */
            --primary-green: #059669; /* Success green */
            --primary-purple: #7c3aed; /* Premium purple */
            --accent-orange: #f59e0b; /* Attention orange */
            --accent-pink: #ec4899; /* Highlight pink */
            
            /* Enhanced Color System */
            --gradient-primary: linear-gradient(135deg, #1e40af 0%, #3b82f6 50%, #06b6d4 100%);
            --gradient-success: linear-gradient(135deg, #059669 0%, #10b981 50%, #34d399 100%);
            --gradient-warm: linear-gradient(135deg, #f59e0b 0%, #f97316 50%, #ec4899 100%);
            
            /* Neutral Colors - Refined */
            --gray-50: #f8fafc;   /* Ultra light background */
            --gray-100: #f1f5f9;  /* Light background */
            --gray-200: #e2e8f0;  /* Border light */
            --gray-300: #cbd5e1;  /* Border medium */
            --gray-400: #94a3b8;  /* Text muted */
            --gray-500: #64748b;  /* Text secondary */
            --gray-600: #475569;  /* Text primary */
            --gray-700: #334155;  /* Text dark */
            --gray-800: #1e293b;  /* Near black */
            --white: #ffffff;

            /* Semantic Colors - Enhanced */
            --success: #10b981; 
            --success-light: #d1fae5;
            --warning: #f59e0b; 
            --warning-light: #fef3c7;
            --error: #ef4444;   
            --error-light: #fee2e2;
            --info: #06b6d4;    
            --info-light: #cffafe;

            /* Enhanced Shadows */
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-glow: 0 0 20px rgba(59, 130, 246, 0.15);

            /* Typography */
            --font-primary: 'Inter', 'Segoe UI', system-ui, sans-serif;
            --font-mono: 'JetBrains Mono', 'Fira Code', monospace;
            
            /* Spacing Scale */
            --space-xs: 0.25rem;
            --space-sm: 0.5rem;
            --space-md: 1rem;
            --space-lg: 1.5rem;
            --space-xl: 2rem;
            --space-2xl: 3rem;
            
            /* Border Radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            --radius-2xl: 1.5rem;
        }

        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap');
        
        body {
            font-family: var(--font-primary);
            background: linear-gradient(135deg, var(--gray-50) 0%, var(--info-light) 20%, var(--gray-100) 100%);
            min-height: 100vh;
            color: var(--gray-700);
            line-height: 1.6;
            font-size: 16px;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            overflow-x: hidden;
        }

        /* Welcome Animation */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-10px);
            }
            60% {
                transform: translateY(-5px);
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
            100% {
                transform: scale(1);
            }
        }

        @keyframes shimmer {
            0% {
                background-position: -200px 0;
            }
            100% {
                background-position: calc(200px + 100%) 0;
            }
        }

        /* Animation Classes */
        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }

        .animate-slide-in-right {
            animation: slideInRight 0.6s ease-out;
        }

        .animate-bounce {
            animation: bounce 2s infinite;
        }

        .animate-pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }

        .animate-delay-100 {
            animation-delay: 0.1s;
        }

        .animate-delay-200 {
            animation-delay: 0.2s;
        }

        .animate-delay-300 {
            animation-delay: 0.3s;
        }
        
        .modern-gradient-bg {
            background: linear-gradient(135deg, 
                var(--primary-blue) 0%, 
                var(--primary-green) 50%, 
                var(--primary-purple) 100%);
        }
        
        /* Enhanced Financial Cards */
        .financial-card {
            background: var(--white);
            border-radius: var(--radius-2xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--gray-200);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .financial-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .financial-card:hover {
            box-shadow: var(--shadow-xl);
            transform: translateY(-2px);
            border-color: var(--primary-blue);
        }
        
        .financial-card:hover::before {
            opacity: 1;
        }
        
        .financial-card-header {
            background: linear-gradient(135deg, var(--gray-50) 0%, white 100%);
            border-bottom: 1px solid var(--gray-200);
            border-radius: 12px 12px 0 0;
        }
        
        /* Enhanced Metric Cards */
        .metric-card {
            background: var(--white);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--gray-200);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--gray-700);
            position: relative;
            overflow: hidden;
        }
        
        .metric-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent 49%, rgba(255,255,255,0.1) 50%, transparent 51%);
            transform: translateX(-100%);
            transition: transform 0.6s ease;
        }
        
        .metric-card:hover {
            box-shadow: var(--shadow-lg);
            transform: translateY(-1px);
        }
        
        .metric-card:hover::after {
            transform: translateX(100%);
        }
        
        .metric-positive {
            background: linear-gradient(135deg, var(--success-light) 0%, var(--white) 100%);
            border-color: var(--success);
            color: var(--gray-800);
        }
        
        .metric-positive .metric-value {
            color: var(--success);
        }
        
        .metric-neutral {
            background: linear-gradient(135deg, var(--info-light) 0%, var(--white) 100%);
            border-color: var(--info);
            color: var(--gray-800);
        }
        
        .metric-neutral .metric-value {
            color: var(--info);
        }
        
        .metric-warning {
            background: linear-gradient(135deg, var(--warning-light) 0%, var(--white) 100%);
            border-color: var(--warning);
            color: var(--gray-800);
        }
        
        .metric-warning .metric-value {
            color: var(--warning);
        }
        
        /* Enhanced Typography */
        .wealth-amount {
            font-family: var(--font-primary);
            font-weight: 700;
            letter-spacing: -0.025em;
            color: var(--primary-green);
            font-size: 1.5em;
        }
        
        .section-header {
            font-family: var(--font-primary);
            font-weight: 600;
            color: var(--primary-blue);
            letter-spacing: -0.025em;
            margin-bottom: var(--space-lg);
        }
        
        /* Enhanced Form Inputs */
        .financial-input {
            border: 1px solid var(--gray-300);
            border-radius: var(--radius-lg);
            padding: var(--space-lg) var(--space-lg);
            font-size: 16px;
            background: var(--white);
            color: var(--gray-700);
            box-shadow: var(--shadow-sm);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            width: 100%;
        }
        
        .financial-input:focus {
            border-color: var(--primary-blue);
            box-shadow: 0 0 0 3px rgba(30, 64, 175, 0.1), var(--shadow-md);
            outline: none;
            background: var(--gray-50);
        }
        
        .financial-input:hover {
            border-color: var(--gray-400);
        }
        
        /* Enhanced Buttons */
        .btn-primary {
            background: var(--gradient-primary);
            color: var(--white);
            border: none;
            border-radius: var(--radius-lg);
            padding: var(--space-lg) var(--space-xl);
            font-weight: 600;
            font-size: 16px;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-md);
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s ease;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-xl);
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        .btn-primary:active {
            transform: translateY(0);
            box-shadow: var(--shadow-md);
        }
        
        /* Secondary Button */
        .btn-secondary {
            background: var(--white);
            color: var(--primary-blue);
            border: 2px solid var(--primary-blue);
            border-radius: var(--radius-lg);
            padding: var(--space-lg) var(--space-xl);
            font-weight: 600;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-sm);
        }
        
        .btn-secondary:hover {
            background: var(--primary-blue);
            color: var(--white);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }
        
        /* Progress Components */
        .progress-bar {
            background: var(--gray-200);
            border-radius: var(--radius-xl);
            overflow: hidden;
            height: 12px;
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        
        .progress-fill {
            background: var(--gradient-success);
            height: 100%;
            border-radius: var(--radius-xl);
            transition: width 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            bottom: 0;
            right: 0;
            background: linear-gradient(45deg, 
                transparent 30%, 
                rgba(255,255,255,0.3) 50%, 
                transparent 70%);
            animation: shimmer 2s infinite;
        }
        
        /* Welcome Banner */
        .welcome-banner {
            background: var(--gradient-primary);
            color: var(--white);
            padding: var(--space-2xl);
            border-radius: var(--radius-2xl);
            margin-bottom: var(--space-xl);
            box-shadow: var(--shadow-xl);
            position: relative;
            overflow: hidden;
        }
        
        .welcome-banner::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 20%, transparent 70%);
            animation: pulse 3s ease-in-out infinite;
        }
        
        /* Feature Highlights */
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: var(--space-lg);
            margin-bottom: var(--space-2xl);
        }
        
        .feature-card {
            background: var(--white);
            padding: var(--space-xl);
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-md);
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--gray-200);
        }
        
        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-blue);
        }
        
        .feature-icon {
            font-size: 3rem;
            margin-bottom: var(--space-md);
            display: block;
        }
        
        .feature-title {
            font-size: 1.25rem;
            font-weight: 600;
            color: var(--gray-800);
            margin-bottom: var(--space-sm);
        }
        
        .feature-description {
            color: var(--gray-600);
            line-height: 1.6;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 30px;
            max-width: 1600px; /* Increased max-width */
            margin: 0 auto;
        }
        
        @media (max-width: 1024px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }
        
        .sidebar-panel {
            background: linear-gradient(160deg, var(--mid-dark-bg) 0%, #3a005d 100%);
            border-radius: 10px;
            box-shadow: 0 0 20px var(--neon-purple), 0 0 8px var(--neon-pink) inset;
            border: 2px solid var(--neon-blue);
            position: sticky;
            top: 30px;
            height: fit-content;
        }
        
        .tab-modern {
            padding: 12px 25px;
            border: none;
            background: var(--mid-dark-bg);
            color: var(--neon-green);
            font-weight: bold;
            border-radius: 8px;
            transition: all 0.3s ease-in-out;
            position: relative;
            text-shadow: 0 0 5px var(--neon-green);
            box-shadow: 0 0 8px rgba(0, 255, 0, 0.3);
        }
        
        .tab-modern.active {
            color: var(--neon-pink);
            background: linear-gradient(45deg, var(--neon-purple), var(--neon-blue));
            box-shadow: 0 0 15px var(--neon-pink);
            text-shadow: 0 0 8px var(--neon-pink);
        }
        
        .tab-modern.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 4px;
            background: var(--neon-pink);
            border-radius: 2px;
            box-shadow: 0 0 10px var(--neon-pink);
        }
        
        .animate-slide-up {
            animation: slideUp 0.5s ease-out forwards;
        }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.6s ease-out forwards;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Custom scrollbar - 80s style */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--dark-bg);
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--neon-blue);
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--neon-pink);
        }
        
        /* Status indicators */
        .status-excellent { color: var(--neon-green); text-shadow: 0 0 5px var(--neon-green); }
        .status-good { color: var(--neon-blue); text-shadow: 0 0 5px var(--neon-blue); }
        .status-warning { color: var(--neon-pink); text-shadow: 0 0 5px var(--neon-pink); }
        .status-poor { color: #FF0000; text-shadow: 0 0 5px #FF0000; }
        
        /* High contrast headers and buttons - VERY SIGNIFICANT COLORS */
        .header-primary {
            color: var(--neon-blue) !important;
            font-weight: 900 !important;
            text-shadow: 0 0 15px var(--neon-blue), 0 0 5px var(--neon-green) !important;
            text-decoration: none !important;
            font-family: var(--font-display);
        }
        
        .header-secondary {
            color: var(--neon-pink) !important;
            font-weight: 800 !important;
            text-shadow: 0 0 10px var(--neon-pink) !important;
            font-family: var(--font-display);
        }
        
        /* Main page title - EXTRA prominent */
        h1.header-primary {
            color: var(--neon-green) !important;
            font-weight: 900 !important;
            font-size: 3.5rem !important;
            text-shadow: 0 0 20px var(--neon-green), 0 0 10px var(--neon-blue) !important;
            letter-spacing: 0.1em !important;
        }
        
        /* Section headers - Very prominent */
        h2.header-primary {
            color: var(--neon-blue) !important;
            font-weight: 800 !important;
            font-size: 2rem !important;
            text-shadow: 0 0 15px var(--neon-blue) !important;
        }
        
        /* Component titles - Prominent */
        h3.header-primary {
            color: var(--neon-pink) !important;
            font-weight: 800 !important;
            font-size: 1.5rem !important;
            text-shadow: 0 0 10px var(--neon-pink) !important;
        }
        
        /* VERY PROMINENT BUTTONS */
        .btn-enhanced {
            font-weight: 800 !important;
            font-size: 16px !important;
            text-shadow: 0 0 8px var(--neon-blue) !important;
            box-shadow: 0 0 15px var(--neon-purple) !important;
            border: 2px solid var(--neon-blue) !important;
            transition: all 0.3s ease !important;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--neon-purple), var(--neon-pink)) !important;
            color: var(--white) !important;
            font-weight: 800 !important;
            font-size: 16px !important;
            text-shadow: 0 0 8px var(--neon-blue) !important;
            box-shadow: 0 0 15px var(--neon-purple) !important;
            border: 2px solid var(--neon-blue) !important;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-blue)) !important;
            box-shadow: 0 0 20px var(--neon-blue) !important;
            transform: translateY(-2px) !important;
        }
        
        .btn-secondary {
            background: var(--mid-dark-bg) !important;
            color: var(--neon-green) !important;
            font-weight: 800 !important;
            font-size: 16px !important;
            text-shadow: 0 0 5px var(--neon-green) !important;
            box-shadow: 0 0 10px var(--neon-green) !important;
            border: 2px solid var(--neon-green) !important;
        }
        
        .btn-secondary:hover {
            border-color: var(--neon-pink) !important;
            color: var(--neon-pink) !important;
            box-shadow: 0 0 15px var(--neon-pink) !important;
            transform: translateY(-2px) !important;
        }
        
        /* WEALTH AMOUNTS AND IMPORTANT VALUES - Very prominent */
        .wealth-amount {
            color: var(--neon-blue) !important;
            font-weight: 900 !important;
            font-size: 1.2em !important;
            text-shadow: 0 0 10px var(--neon-blue) !important;
            letter-spacing: 0.05em !important;
        }
        
        /* Key financial metrics */
        .metric-card {
            border: 2px solid var(--neon-blue) !important;
            box-shadow: 0 0 10px rgba(0, 255, 255, 0.5) !important;
            transition: all 0.3s ease !important;
            background: rgba(0, 0, 0, 0.4) !important;
        }
        
        .metric-card:hover {
            border-color: var(--neon-pink) !important;
            box-shadow: 0 0 15px var(--neon-pink) !important;
            transform: translateY(-2px) !important;
        }
        
        /* Section headers - Make them VERY noticeable */
        .section-header {
            color: var(--neon-green) !important;
            font-weight: 800 !important;
            font-size: 1.3em !important;
            text-shadow: 0 0 10px var(--neon-green) !important;
            border-bottom: 3px solid var(--neon-blue) !important;
            padding-bottom: 8px !important;
            margin-bottom: 16px !important;
            font-family: var(--font-display);
        }
        
        /* Tab buttons - Very prominent */
        button[class*="tab"] {
            font-weight: 800 !important;
            font-size: 15px !important;
            text-shadow: 0 0 5px var(--neon-green) !important;
            border: 2px solid var(--neon-blue) !important;
            transition: all 0.3s ease !important;
            background: var(--mid-dark-bg);
            color: var(--neon-green);
        }
        
        button[class*="tab"]:hover {
            box-shadow: 0 0 10px var(--neon-blue) !important;
            transform: translateY(-1px) !important;
        }
        
        button[class*="tab"].active {
            color: var(--neon-pink) !important;
            background: linear-gradient(45deg, var(--neon-purple), var(--neon-blue)) !important;
            box-shadow: 0 0 15px var(--neon-pink) !important;
            text-shadow: 0 0 8px var(--neon-pink) !important;
            border-color: var(--neon-pink) !important;
        }
        
        /* RTL support enhanced */
        [dir="rtl"] .ml-2 { margin-left: 0; margin-right: 0.5rem; }
        [dir="rtl"] .mr-2 { margin-right: 0; margin-left: 0.5rem; }
        [dir="ltr"] .ml-2 { margin-left: 0.5rem; margin-right: 0; }
        [dir="ltr"] .mr-2 { margin-right: 0.5rem; margin-left: 0; }
        
        /* Mobile responsiveness */
        @media (max-width: 768px) {
            body { font-size: 14px; }
            .dashboard-grid { padding: 15px; gap: 15px; }
            .financial-card { border-radius: 8px; }
            .sidebar-panel { position: relative; top: 0; }
            h1.header-primary { font-size: 2.5rem !important; }
            h2.header-primary { font-size: 1.5rem !important; }
            h3.header-primary { font-size: 1.2rem !important; }
        }
        
        /* Print styles */
        @media print {
            .sidebar-panel { position: relative; }
            .btn-primary, .btn-secondary { color: black !important; }
        }
        }
        
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        /* Custom scrollbar - Modern style */
        ::-webkit-scrollbar {
            width: 6px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--gray-100);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: var(--gray-300);
            border-radius: 3px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--gray-400);
        }
        
        /* Status indicators */
        .status-excellent { color: var(--wealth-green); }
        .status-good { color: var(--primary-blue); }
        .status-warning { color: var(--warning); }
        .status-poor { color: var(--error); }
        
        /* High contrast headers and buttons - VERY SIGNIFICANT COLORS */
        .header-primary {
            color: var(--primary-blue) !important;
            font-weight: 900 !important;
            text-shadow: 0 2px 4px rgba(0, 102, 204, 0.3) !important;
            text-decoration: none !important;
        }
        
        .header-secondary {
            color: var(--primary-purple) !important;
            font-weight: 800 !important;
            text-shadow: 0 2px 3px rgba(108, 92, 231, 0.25) !important;
        }
        
        /* Main page title - EXTRA prominent */
        h1.header-primary {
            color: var(--primary-blue) !important;
            font-weight: 900 !important;
            font-size: 2.5rem !important;
            text-shadow: 0 3px 6px rgba(0, 102, 204, 0.4) !important;
            letter-spacing: -0.02em !important;
        }
        
        /* Section headers - Very prominent */
        h2.header-primary {
            color: var(--wealth-green) !important;
            font-weight: 800 !important;
            font-size: 1.75rem !important;
            text-shadow: 0 2px 4px rgba(22, 163, 74, 0.3) !important;
        }
        
        /* Component titles - Prominent */
        h3.header-primary {
            color: var(--primary-purple) !important;
            font-weight: 800 !important;
            font-size: 1.25rem !important;
            text-shadow: 0 2px 3px rgba(108, 92, 231, 0.25) !important;
        }
        
        /* VERY PROMINENT BUTTONS */
        .btn-enhanced {
            font-weight: 800 !important;
            font-size: 16px !important;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3) !important;
            box-shadow: var(--shadow-xl) !important;
            border: 2px solid transparent !important;
            transition: all 0.3s ease !important;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-blue), var(--growth-blue)) !important;
            color: white !important;
            font-weight: 800 !important;
            font-size: 16px !important;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4) !important;
            box-shadow: 0 8px 20px rgba(0, 102, 204, 0.3) !important;
            border: 3px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, var(--growth-blue), var(--primary-blue)) !important;
            box-shadow: 0 12px 25px rgba(0, 102, 204, 0.4) !important;
            transform: translateY(-2px) !important;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-orange)) !important;
            color: white !important;
            font-weight: 800 !important;
            font-size: 16px !important;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.4) !important;
            box-shadow: 0 8px 20px rgba(108, 92, 231, 0.3) !important;
            border: 3px solid rgba(255, 255, 255, 0.2) !important;
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, var(--accent-orange), var(--primary-purple)) !important;
            box-shadow: 0 12px 25px rgba(108, 92, 231, 0.4) !important;
            transform: translateY(-2px) !important;
        }
        
        /* WEALTH AMOUNTS AND IMPORTANT VALUES - Very prominent */
        .wealth-amount {
            color: var(--wealth-green) !important;
            font-weight: 900 !important;
            font-size: 1.1em !important;
            text-shadow: 0 2px 4px rgba(22, 163, 74, 0.25) !important;
            letter-spacing: -0.01em !important;
        }
        
        /* Key financial metrics */
        .metric-card {
            border: 2px solid rgba(0, 102, 204, 0.1) !important;
            box-shadow: 0 4px 12px rgba(0, 102, 204, 0.15) !important;
            transition: all 0.3s ease !important;
        }
        
        .metric-card:hover {
            border-color: rgba(0, 102, 204, 0.3) !important;
            box-shadow: 0 8px 20px rgba(0, 102, 204, 0.25) !important;
            transform: translateY(-2px) !important;
        }
        
        /* Section headers - Make them VERY noticeable */
        .section-header {
            color: var(--primary-blue) !important;
            font-weight: 800 !important;
            font-size: 1.2em !important;
            text-shadow: 0 2px 4px rgba(0, 102, 204, 0.2) !important;
            border-bottom: 3px solid var(--primary-blue) !important;
            padding-bottom: 8px !important;
            margin-bottom: 16px !important;
        }
        
        /* Tab buttons - Very prominent */
        button[class*="tab"] {
            font-weight: 800 !important;
            font-size: 15px !important;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3) !important;
            border: 2px solid transparent !important;
            transition: all 0.3s ease !important;
        }
        
        /* RTL support enhanced */
        [dir="rtl"] .ml-2 { margin-left: 0; margin-right: 0.5rem; }
        [dir="rtl"] .mr-2 { margin-right: 0; margin-left: 0.5rem; }
        [dir="ltr"] .ml-2 { margin-left: 0.5rem; margin-right: 0; }
        [dir="ltr"] .mr-2 { margin-right: 0.5rem; margin-left: 0; }
        
        /* Mobile responsiveness */
        @media (max-width: 768px) {
            body { font-size: 13px; }
            .dashboard-grid { padding: 16px; gap: 16px; }
            .financial-card { border-radius: 8px; }
            .sidebar-panel { position: relative; top: 0; }
        }
        
        /* Print styles */
        @media print {
            .sidebar-panel { position: relative; }
            .btn-primary, .btn-secondary { color: black !important; }
        }
    </style>
</head>
<body>
    <div id="progress-bar-container" class="hidden">
        <!-- Progress bar will be injected here by React -->
    </div>
    <div id="tutorial-overlay" class="hidden">
        <!-- Tutorial will be injected here by React -->
    </div>
    <div id="welcome-banner" class="hidden">
        <!-- Welcome message will be injected here by React -->
    </div>
    <div id="root" class="min-h-screen"></div>
    <!-- The ErrorBoundary component is defined in app-main.js and used for error handling. -->
    
    <!-- Loading indicator while dependencies load -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const root = document.getElementById('root');
            // Create loading screen safely
            const createLoadingScreen = () => {
                const container = document.createElement('div');
                container.className = 'min-h-screen bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 flex items-center justify-center';
                
                const centerDiv = document.createElement('div');
                centerDiv.className = 'text-center';
                
                const spinner = document.createElement('div');
                spinner.className = 'animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600 mx-auto mb-4';
                
                const hebrewText = document.createElement('p');
                hebrewText.className = 'text-gray-600 text-lg';
                hebrewText.textContent = 'טוען מתכנן פרישה מתקדם...';
                
                const englishText = document.createElement('p');
                englishText.className = 'text-gray-500 text-sm mt-2';
                englishText.textContent = 'Loading Advanced Retirement Planner...';
                
                const statusDiv = document.createElement('div');
                statusDiv.className = 'mt-4 text-xs text-gray-400';
                const statusText = document.createElement('div');
                statusText.textContent = '🔄 Loading core modules...';
                statusDiv.appendChild(statusText);
                
                centerDiv.appendChild(spinner);
                centerDiv.appendChild(hebrewText);
                centerDiv.appendChild(englishText);
                centerDiv.appendChild(statusDiv);
                container.appendChild(centerDiv);
                
                return container;
            };
            
            root.appendChild(createLoadingScreen());
        });

        // Global utility functions
        const safeValue = (value) => isNaN(value) || !isFinite(value) ? 0 : Math.max(0, value);
        
        // Security helper - safe innerHTML replacement for controlled content only
        const safeSetHTML = (element, htmlString) => {
            // Only allow innerHTML for internal, controlled content (not user input)
            // This is safe as we control all the HTML strings in our application
            element.innerHTML = htmlString;
        };

        // Enhanced dependency check function with detailed reporting
        function checkDependencies() {
            console.log('🔍 Checking dependencies...');
            
            // Detailed dependency information
            const deps = {
                React: { 
                    available: typeof React !== 'undefined',
                    version: typeof React !== 'undefined' ? React.version : 'N/A',
                    source: 'https://unpkg.com/react@18/umd/react.development.js'
                },
                ReactDOM: { 
                    available: typeof ReactDOM !== 'undefined',
                    version: typeof ReactDOM !== 'undefined' ? ReactDOM.version : 'N/A',
                    source: 'https://unpkg.com/react-dom@18/umd/react-dom.development.js'
                },
                Chart: { 
                    available: typeof Chart !== 'undefined',
                    version: typeof Chart !== 'undefined' ? Chart.version : 'N/A',
                    source: 'https://cdn.jsdelivr.net/npm/chart.js'
                }
            };
            
            // Log detailed information
            Object.entries(deps).forEach(([name, info]) => {
                console.log(`${name}:`, info.available ? `✅ v${info.version}` : '❌ Missing');
            });
            
            const missing = Object.entries(deps)
                .filter(([name, info]) => !info.available)
                .map(([name, info]) => ({ name, source: info.source }));
            
            if (missing.length > 0) {
                console.error('❌ Missing dependencies:', missing.map(d => d.name));
                
                const missingDetails = missing.map(dep => 
                    `<li><strong>${dep.name}</strong><br><small>${dep.source}</small></li>`
                ).join('');
                
                // Create error screen safely
                const createErrorScreen = (missingDetails) => {
                    const container = document.createElement('div');
                    container.className = 'min-h-screen bg-gradient-to-br from-red-50 via-orange-50 to-yellow-50 flex items-center justify-center p-4';
                    
                    const content = document.createElement('div');
                    content.className = 'text-center max-w-lg';
                    
                    const icon = document.createElement('div');
                    icon.className = 'text-red-500 text-6xl mb-4';
                    icon.textContent = '⚠️';
                    
                    const title = document.createElement('h2');
                    title.className = 'text-2xl font-bold text-red-700 mb-4';
                    title.textContent = 'Dependency Loading Error';
                    
                    const description = document.createElement('p');
                    description.className = 'text-gray-700 mb-4';
                    description.textContent = 'The following required libraries failed to load:';
                    
                    const errorList = document.createElement('ul');
                    errorList.className = 'text-left bg-red-100 border border-red-300 rounded-lg p-4 mb-4';
                    safeSetHTML(errorList, missingDetails); // Safe here as missingDetails is generated internally
                    
                    const note = document.createElement('p');
                    note.className = 'text-gray-600 text-sm mb-4';
                    note.textContent = 'This might be due to network issues or CDN availability problems.';
                    
                    const buttonContainer = document.createElement('div');
                    buttonContainer.className = 'space-y-2';
                    
                    const retryBtn = document.createElement('button');
                    retryBtn.id = 'retryBtn1';
                    retryBtn.className = 'bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors block w-full';
                    retryBtn.textContent = 'Retry Loading';
                    
                    const debugBtn = document.createElement('button');
                    debugBtn.id = 'debugBtn';
                    debugBtn.className = 'bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors block w-full';
                    debugBtn.textContent = 'Open Browser Test Page';
                    
                    buttonContainer.appendChild(retryBtn);
                    buttonContainer.appendChild(debugBtn);
                    
                    content.appendChild(icon);
                    content.appendChild(title);
                    content.appendChild(description);
                    content.appendChild(errorList);
                    content.appendChild(note);
                    content.appendChild(buttonContainer);
                    container.appendChild(content);
                    
                    return container;
                };
                
                const root = document.getElementById('root');
                root.textContent = ''; // Clear existing content
                root.appendChild(createErrorScreen(missingDetails));
                
                // Add event listeners
                setTimeout(() => {
                    const retryBtn = document.getElementById('retryBtn1');
                    const debugBtn = document.getElementById('debugBtn');
                    
                    if (retryBtn) {
                        retryBtn.addEventListener('click', () => location.reload());
                    }
                    if (debugBtn) {
                        debugBtn.addEventListener('click', () => {
                            window.open('./test-browser.html', '_blank');
                        });
                    }
                }, 100);
                return false;
            }
            
            console.log('✅ All dependencies loaded successfully!');
            return true;
        }

        // Module loading and initialization
        async function initializeApp() {
            try {
                console.log('🚀 Starting application initialization...');
                
                // Update loading message
                const loadingDiv = document.querySelector('.text-center');
                if (loadingDiv) {
                    safeSetHTML(loadingDiv, `
                        <div class="animate-spin rounded-full h-16 w-16 border-b-2 border-purple-600 mx-auto mb-4"></div>
                        <p class="text-gray-600 text-lg">טוען מודולי ליבה...</p>
                        <p class="text-gray-500 text-sm mt-2">Loading Core Modules...</p>
                        <div class="mt-4 text-xs text-gray-400">
                            <div>📦 Loading Dynamic Loader...</div>
                        </div>
                    `);
                }

                // Load dynamic loader first
                await loadScript('./src/core/dynamic-loader.js?v=4.5.0');
                console.log('✅ Dynamic loader loaded');

                // Update loading message
                if (loadingDiv) {
                    safeSetHTML(loadingDiv.querySelector('.text-xs'), '<div>🎯 Loading Core Application...</div>');
                }

                // Load core application
                await loadScript('./src/core/app-main.js?v=4.5.0');
                console.log('✅ Core application loaded');

                // Initialize the core application
                window.initializeRetirementPlannerCore();

            } catch (error) {
                console.error('❌ Application initialization failed:', error);
                safeSetHTML(document.getElementById('root'), `
                    <div class="min-h-screen bg-gradient-to-br from-red-50 via-orange-50 to-yellow-50 flex items-center justify-center p-4">
                        <div class="text-center max-w-md">
                            <div class="text-red-500 text-6xl mb-4">💥</div>
                            <h2 class="text-2xl font-bold text-red-700 mb-4">Application Error</h2>
                            <p class="text-gray-700 mb-4">
                                Failed to initialize the retirement planner:
                            </p>
                            <div class="bg-red-100 border border-red-300 rounded-lg p-3 mb-4">
                                <code class="text-red-700 text-sm">${error.message}</code>
                            </div>
                            <button id="retryBtn2" class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors">
                                Reload Application
                            </button>
                        </div>
                    </div>
                `);
                // Add event listener for retry button
                setTimeout(() => {
                    const retryBtn = document.getElementById('retryBtn2');
                    if (retryBtn) {
                        retryBtn.addEventListener('click', () => location.reload());
                    }
                }, 100);
            }
        }

        // Helper function to load scripts dynamically with retry logic
        function loadScript(src, retries = 2) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = src;
                script.async = true;
                
                script.onload = () => {
                    console.log(`✅ Loaded: ${src}`);
                    resolve();
                };
                
                script.onerror = () => {
                    console.error(`❌ Failed to load: ${src}`);
                    document.head.removeChild(script);
                    
                    if (retries > 0) {
                        console.log(`🔄 Retrying to load: ${src} (${retries} attempts left)`);
                        setTimeout(() => {
                            loadScript(src, retries - 1).then(resolve).catch(reject);
                        }, 1000);
                    } else {
                        // Show detailed error information
                        const errorDetails = `
                            <div class="bg-red-100 border border-red-300 rounded-lg p-3 mb-4">
                                <h4 class="font-bold text-red-700">Failed to load script:</h4>
                                <code class="text-red-600 text-sm break-all">${src}</code>
                                <p class="text-red-600 text-sm mt-2">This might be due to network issues or missing files.</p>
                            </div>
                        `;
                        
                        safeSetHTML(document.getElementById('root'), `
                            <div class="min-h-screen bg-gradient-to-br from-red-50 via-orange-50 to-yellow-50 flex items-center justify-center p-4">
                                <div class="text-center max-w-lg">
                                    <div class="text-red-500 text-6xl mb-4">📡</div>
                                    <h2 class="text-2xl font-bold text-red-700 mb-4">Loading Error</h2>
                                    ${errorDetails}
                                    <div class="space-y-2">
                                        <button id="retryBtn" class="bg-red-500 text-white px-6 py-2 rounded-lg hover:bg-red-600 transition-colors block w-full">
                                            Retry Loading
                                        </button>
                                        <button id="testBtn" class="bg-blue-500 text-white px-6 py-2 rounded-lg hover:bg-blue-600 transition-colors block w-full">
                                            Open Browser Test
                                        </button>
                                    </div>
                                </div>
                            </div>
                        `);
                        
                        // Add event listeners for error page buttons
                        setTimeout(() => {
                            const retryBtn = document.getElementById('retryBtn');
                            const testBtn = document.getElementById('testBtn');
                            
                            if (retryBtn) {
                                retryBtn.addEventListener('click', () => location.reload());
                            }
                            if (testBtn) {
                                testBtn.addEventListener('click', () => window.open('./test-browser.html', '_blank'));
                            }
                        }, 100);
                        
                        reject(new Error(`Failed to load script after retries: ${src}`));
                    }
                };
                
                document.head.appendChild(script);
            });
        }

        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });
    </script>
</body>
</html>