<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Production Score Test - Direct Method</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin: 20px 0;
        }
        h1 {
            color: #333;
            margin: 0 0 20px 0;
        }
        .test-method {
            border: 2px solid #007bff;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            background: #f8f9fa;
        }
        .command-block {
            background: #1e1e1e;
            color: #d4d4d4;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
            font-family: 'Consolas', 'Monaco', monospace;
            position: relative;
            overflow-x: auto;
            cursor: pointer;
        }
        .command-block:hover {
            background: #2a2a2a;
        }
        .copy-btn {
            position: absolute;
            right: 10px;
            top: 10px;
            background: #28a745;
            color: white;
            border: none;
            padding: 5px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        .copy-btn:hover {
            background: #218838;
        }
        .manual-test {
            background: #e3f2fd;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #2196f3;
            margin: 15px 0;
        }
        .critical {
            background: #dc3545;
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
        }
        .success {
            background: #28a745;
            color: white;
            padding: 15px;
            border-radius: 8px;
            font-weight: bold;
            text-align: center;
            margin: 20px 0;
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 10px 10px 0;
        }
        button:hover {
            background: #0056b3;
        }
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        .data-table th, .data-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .data-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        .data-table td.value {
            font-family: monospace;
            color: #007bff;
        }
        .warning {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            color: #856404;
            padding: 15px;
            border-radius: 4px;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üéØ Direct Production Score Test</h1>
        <p>Since the wizard object isn't directly accessible, let's test the scoring function directly.</p>
        
        <button onclick="window.open('https://ypollak2.github.io/advanced-retirement-planner/', '_blank')">
            Open Production App
        </button>
    </div>

    <div class="container">
        <h2>Method 1: Direct Score Calculation</h2>
        <p>This bypasses the wizard entirely and tests the scoring engine directly:</p>
        
        <div class="test-method">
            <h3>Test the Scoring Engine Directly</h3>
            <p>Copy and paste this command in the console of the production app:</p>
            
            <div class="command-block" onclick="copyToClipboard(this)">
// Direct test of financial health scoring
(function testFinancialHealthScore() {
    // High-income test data
    const testData = {
        planningType: 'individual',
        currentAge: 35,
        retirementAge: 67,
        currentMonthlySalary: 50000,
        currentMonthlyExpenses: 25000,
        currentPension: 500000,
        currentTrainingFund: 300000,
        currentPortfolio: 200000,
        emergencyFund: 150000,
        pensionContributionRate: 18.5,
        trainingFundContributionRate: 10,
        riskTolerance: 'balanced',
        expectedAnnualReturn: 7,
        country: 'israel',
        currentSavingsAccount: 50000,
        currentRealEstate: 0,
        currentCrypto: 0
    };

    console.log('üß™ Testing Financial Health Score...');
    console.log('üìä Test Profile: High-income individual, age 35');
    console.log('‚úÖ Expected Score: 70-90');
    console.log('‚ùå Bug if Score: 27-29\n');

    // Check if function exists
    if (typeof window.calculateFinancialHealthScore !== 'function') {
        console.error('‚ùå calculateFinancialHealthScore not found!');
        console.log('Trying to load it...');
        
        // Try to load from the global scope
        const scripts = document.querySelectorAll('script');
        scripts.forEach(script => {
            if (script.src.includes('financialHealth')) {
                console.log('Found script:', script.src);
            }
        });
        return;
    }

    // Calculate score
    try {
        const result = window.calculateFinancialHealthScore(testData, {
            combinePartners: false,
            debugMode: true
        });

        console.log('='.repeat(60));
        console.log('üìä RESULTS:');
        console.log('='.repeat(60));
        console.log(`üéØ Total Score: ${result.totalScore}`);
        
        if (result.totalScore >= 27 && result.totalScore <= 29) {
            console.error('‚ùå CRITICAL BUG DETECTED!');
            console.error('Score is in the 27-29 range!');
            console.error('THE BUG IS STILL PRESENT!');
        } else if (result.totalScore >= 70 && result.totalScore <= 90) {
            console.log('‚úÖ SUCCESS! Score is in expected range!');
            console.log('The bug appears to be FIXED!');
        } else {
            console.warn(`‚ö†Ô∏è Score ${result.totalScore} is outside expected range (70-90)`);
        }

        console.log('\nüìä Factor Breakdown:');
        if (result.factorScores) {
            Object.entries(result.factorScores).forEach(([factor, data]) => {
                const score = data.score || 0;
                const max = data.maxScore || data.weight || 0;
                console.log(`${factor}: ${score}/${max}`);
            });
        }

        console.log('='.repeat(60));
        
        return result;
    } catch (error) {
        console.error('‚ùå Error calculating score:', error);
    }
})();
                <button class="copy-btn">Copy</button>
            </div>
        </div>
    </div>

    <div class="container">
        <h2>Method 2: Manual Wizard Test</h2>
        <div class="manual-test">
            <h3>Manual Test Instructions</h3>
            <p>If the direct test doesn't work, follow these manual steps:</p>
            
            <ol>
                <li><strong>Start the wizard</strong> in the production app</li>
                <li><strong>Use this test data:</strong></li>
            </ol>
            
            <table class="data-table">
                <tr>
                    <th>Step</th>
                    <th>Field</th>
                    <th>Value</th>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Planning Type</td>
                    <td class="value">Individual</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Current Age</td>
                    <td class="value">35</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Retirement Age</td>
                    <td class="value">67</td>
                </tr>
                <tr>
                    <td>1</td>
                    <td>Country</td>
                    <td class="value">Israel</td>
                </tr>
                <tr>
                    <td>2</td>
                    <td>Monthly Salary</td>
                    <td class="value">50,000 ILS</td>
                </tr>
                <tr>
                    <td>3</td>
                    <td>Monthly Expenses</td>
                    <td class="value">25,000 ILS</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Pension</td>
                    <td class="value">500,000 ILS</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Training Fund</td>
                    <td class="value">300,000 ILS</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Portfolio</td>
                    <td class="value">200,000 ILS</td>
                </tr>
                <tr>
                    <td>4</td>
                    <td>Emergency Fund</td>
                    <td class="value">150,000 ILS</td>
                </tr>
            </table>
            
            <p>Continue through steps 5-8 with default values, then calculate at step 9.</p>
        </div>
    </div>

    <div class="container">
        <h2>Method 3: Check if Scoring Function Exists</h2>
        <p>First, let's check what functions are available:</p>
        
        <div class="command-block" onclick="copyToClipboard(this)">
// Check what financial health functions are available
console.log('üîç Checking for financial health functions...\n');

// Check global functions
const globalFuncs = Object.keys(window).filter(key => 
    key.toLowerCase().includes('financial') || 
    key.toLowerCase().includes('health') ||
    key.toLowerCase().includes('score')
);

console.log('Global functions found:', globalFuncs);

// Check for specific functions
const funcsToCheck = [
    'calculateFinancialHealthScore',
    'financialHealthEngine',
    'calculateHealthScore',
    'getFinancialHealthScore'
];

funcsToCheck.forEach(func => {
    if (window[func]) {
        console.log(`‚úÖ ${func} exists`);
    } else {
        console.log(`‚ùå ${func} not found`);
    }
});

// Check loaded scripts
console.log('\nüìö Financial health related scripts:');
Array.from(document.querySelectorAll('script')).forEach(script => {
    if (script.src && script.src.includes('financial')) {
        console.log(script.src);
    }
});
            <button class="copy-btn">Copy</button>
        </div>
    </div>

    <div class="container">
        <h2>Expected Results</h2>
        
        <div class="success">
            ‚úÖ GOOD: Score between 70-90 = Bug is fixed!
        </div>
        
        <div class="critical">
            ‚ùå BAD: Score between 27-29 = Bug still exists!
        </div>
        
        <div class="warning">
            <strong>Note:</strong> If none of the console commands work, the scoring function may not be globally accessible. In that case, use the manual test method and report the score you get at step 9.
        </div>
    </div>

    <script>
        function copyToClipboard(element) {
            const codeBlock = element.cloneNode(true);
            const button = codeBlock.querySelector('.copy-btn');
            if (button) button.remove();
            
            const text = codeBlock.textContent.trim();
            
            navigator.clipboard.writeText(text).then(() => {
                const btn = element.querySelector('.copy-btn');
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                btn.style.background = '#28a745';
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '#28a745';
                }, 2000);
            }).catch(err => {
                alert('Failed to copy. Please select and copy manually.');
            });
        }
    </script>
</body>
</html>